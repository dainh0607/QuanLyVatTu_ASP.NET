@model IEnumerable<QuanLyVatTu_ASP.Areas.Admin.Models.VatTu>
@{
    ViewData["Title"] = "Danh mục sản phẩm";
    Layout = "~/Views/Shared/_Layout_Customer.cshtml";
}

<div class="categories-page">
    <div class="container">
        <div class="page-header">
            <h1>Sản phẩm</h1>
        </div>

        <div class="categories-filter">
            <div class="filter-sidebar">
                <h3>Danh mục</h3>
                <ul class="list-group">
                    @if (ViewBag.Categories != null)
                    {
                        foreach (var cat in (ViewBag.Categories as IEnumerable<QuanLyVatTu_ASP.Areas.Admin.Models.LoaiVatTu>) ?? Enumerable.Empty<QuanLyVatTu_ASP.Areas.Admin.Models.LoaiVatTu>())
                        {
                            <li class="list-group-item"><a href="/SanPham?loaiId=@cat.ID">@cat.TenLoaiVatTu</a></li>
                        }
                    }
                </ul>
            </div>

            <div class="products-content">
<div class="products-grid">
            @if (Model != null && Model.Any())
            {
                foreach (var product in Model)
                {
                    <div class="product-card">
                        <div class="product-img-wrapper">
                            <span class="discount-badge">-15%</span>
                            
                            <a href="@Url.Action("ProductDetail", "SanPham", new { id = product.ID })">
                                <img src="https://placehold.co/300x300?text=@product.TenVatTu" alt="@product.TenVatTu" loading="lazy" />
                            </a>
                        </div>

                        <div class="product-info">
                            <h3 class="product-name">
                                <a href="@Url.Action("ProductDetail", "SanPham", new { id = product.ID })">@product.TenVatTu</a>
                            </h3>
                            
                            <div class="rating">
                                <i class="fas fa-star"></i> 4.5 <span class="text-muted">(50)</span>
                            </div>

                            <div class="price-box">
                                <span class="current-price">@product.GiaBan.ToString("N0") đ</span>
                            </div>

                            @if (product.SoLuongTon > 0)
                            {
                                <button class="btn-add-cart" onclick="addToCartIndex(@product.ID)">
                                    Thêm vào giỏ
                                </button>
                            }
                            else
                            {
                                <button class="btn-add-cart" disabled>Hết hàng</button>
                            }
                        </div>
                    </div>
                }
            }
            else
            {
                <p class="text-center w-100">Chưa có sản phẩm nào.</p>
            }
        </div>
    </section>
</div>
            </div>
        </div>
    </div>
</div>


    <script>
        function quickAdd(id) {
             $.post('/GioHang/AddToCart', { productId: id, quantity: 1 }, function(res) {
                if(res.success) alert(res.message);
            });
        }
    </script>

    <link rel="stylesheet" href="~/user/css/categories.css" />